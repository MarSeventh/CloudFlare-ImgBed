"use strict";(self["webpackChunksanyue_imghub"]=self["webpackChunksanyue_imghub"]||[]).push([[472],{4893:function(e,t,s){s.d(t,{A:function(){return w}});var n=s(6975),i=s(47),a=(s(5331),s(9648),s(9623)),o=(s(6711),s(4632)),l=s(4453),r=s(6768),u=s(4232),d=s(5130);const c={class:"login-container"},h={class:"login-title",tabindex:"0"},p={class:"input-wrapper"};function m(e,t,s,m,f,g){const b=l.A,y=o.A,k=a.WK,w=i.S2,F=n.A;return(0,r.uX)(),(0,r.CE)("div",{class:(0,u.C4)(["login",{"is-focused":f.isFocused}])},[(0,r.bF)(b,{class:"toggle-dark"}),(0,r.bF)(y),(0,r.Lk)("div",c,[(0,r.Lk)("h1",h,(0,u.v_)(s.title),1),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.fields,(e,s)=>((0,r.uX)(),(0,r.CE)("div",{key:e.key,class:"input-container"},[(0,r.Lk)("label",{class:"input-name",ref_for:!0,ref:`inputLabel${s}`,style:(0,u.Tr)({"--underline-width":f.labelUnderlineWidths[s]+"px"})},(0,u.v_)(e.label),5),(0,r.Lk)("div",p,[(0,r.bF)(k,{modelValue:f.formData[e.key],"onUpdate:modelValue":t=>f.formData[e.key]=t,placeholder:e.placeholder,type:e.type||"text","show-password":e.showPassword,class:"password-input",onKeyup:(0,d.jR)(g.handleSubmit,["enter","native"]),onFocus:g.handleInputFocus,onBlur:g.handleInputBlur},null,8,["modelValue","onUpdate:modelValue","placeholder","type","show-password","onKeyup","onFocus","onBlur"]),t[0]||(t[0]=(0,r.Lk)("div",{class:"input-underline"},null,-1))])]))),128)),(0,r.bF)(w,{class:"submit",type:"primary",onClick:g.handleSubmit},{default:(0,r.k6)(()=>[(0,r.eW)((0,u.v_)(s.submitText),1)]),_:1},8,["onClick"])]),(0,r.bF)(F,{class:"footer"})],2)}s(8111),s(7588);var f=s(8401),g=s(8903),b={name:"BaseLogin",mixins:[g.A],props:{title:{type:String,required:!0},fields:{type:Array,required:!0},submitText:{type:String,default:"登录"},backgroundKey:{type:String,required:!0},isAdmin:{type:Boolean,default:!1}},data(){return{formData:{},labelUnderlineWidths:[],isFocused:!1}},computed:{...(0,f.L8)(["userConfig"])},watch:{fields:{handler(){this.$nextTick(()=>{this.calculateLabelWidths()})},deep:!0}},components:{Footer:n.A,ToggleDark:l.A,Logo:o.A},mounted(){this.initFormData(),this.initializeBackground(this.backgroundKey,".login",!this.isAdmin,!0),this.$nextTick(()=>{this.calculateLabelWidths()})},methods:{initFormData(){const e={};this.fields.forEach(t=>{e[t.key]=""}),this.formData=e,this.labelUnderlineWidths=new Array(this.fields.length).fill(0)},calculateLabelWidths(){this.$nextTick(()=>{this.fields.forEach((e,t)=>{const s=this.$refs[`inputLabel${t}`];if(s&&s[0]){const n=document.createElement("canvas"),i=n.getContext("2d"),a=s[0],o=window.getComputedStyle(a);i.font=`${o.fontWeight} ${o.fontSize} ${o.fontFamily}`;const l=i.measureText(e.label).width;this.labelUnderlineWidths[t]=Math.ceil(l)+3}})})},handleSubmit(){this.$emit("submit",{...this.formData})},handleInputFocus(e){this.isFocused=!0;const t=e.target.closest(".input-container");if(t){const e=t.querySelector(".input-wrapper");e&&e.classList.add("focused")}},handleInputBlur(e){this.isFocused=!1;const t=e.target.closest(".input-container");if(t){const e=t.querySelector(".input-wrapper");e&&e.classList.remove("focused")}}}},y=s(1241);const k=(0,y.A)(b,[["render",m],["__scopeId","data-v-06e63a14"]]);var w=k},9206:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var n=s(4893),i=s(6768);function a(e,t,s,a,o,l){const r=n.A;return(0,i.uX)(),(0,i.Wv)(r,{title:l.loginTitle,fields:o.loginFields,"submit-text":"登录","background-key":"loginBkImg","is-admin":!1,onSubmit:l.handleLogin},null,8,["title","fields","onSubmit"])}s(4114);var o=s(4570),l=s.n(o),r=s(9189),u=s(8401),d={data(){return{loginFields:[{key:"password",label:"密码",placeholder:"请输入认证码",type:"password",showPassword:!0}]}},computed:{...(0,u.L8)(["userConfig"]),ownerName(){return this.userConfig?.ownerName||"Sanyue"},loginTitle(){return`登录到 ${this.ownerName} 图床`}},components:{BaseLogin:n.A},methods:{handleLogin(e){const{password:t}=e,s=""===t?"unset":t;r.A.post("/api/login",{authCode:t}).then(e=>{200===e.status?(l().set("authCode",s,"14d"),this.$router.push("/"),this.$message.success("登录成功")):this.$message.error("登录失败，请检查密码是否正确")}).catch(e=>{this.$message.error("登录失败，请检查密码是否正确")})}}},c=s(1241);const h=(0,c.A)(d,[["render",a]]);var p=h}}]);
//# sourceMappingURL=472.2f8c843f.js.map