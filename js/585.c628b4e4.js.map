{"version":3,"file":"js/585.c628b4e4.js","mappings":"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","sources":["webpack://sanyue_imghub/./src/components/BaseLogin.vue?6f2b","webpack://sanyue_imghub/./src/components/BaseLogin.vue","webpack://sanyue_imghub/./src/components/BaseLogin.vue?0ac4","webpack://sanyue_imghub/./src/views/Login.vue?d808","webpack://sanyue_imghub/./src/views/Login.vue","webpack://sanyue_imghub/./src/views/Login.vue?2b97"],"sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, withKeys as _withKeys, createTextVNode as _createTextVNode, withCtx as _withCtx } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login\"\n};\nconst _hoisted_2 = {\n  class: \"login-container\"\n};\nconst _hoisted_3 = {\n  class: \"login-title\",\n  tabindex: \"0\"\n};\nconst _hoisted_4 = {\n  class: \"input-wrapper\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ToggleDark = _resolveComponent(\"ToggleDark\");\n  const _component_Logo = _resolveComponent(\"Logo\");\n  const _component_el_input = _resolveComponent(\"el-input\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_Footer = _resolveComponent(\"Footer\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_ToggleDark, {\n    class: \"toggle-dark\"\n  }), _createVNode(_component_Logo), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"h1\", _hoisted_3, _toDisplayString($props.title), 1), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.fields, (field, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: field.key,\n      class: \"input-container\"\n    }, [_createElementVNode(\"label\", {\n      class: \"input-name\",\n      ref_for: true,\n      ref: `inputLabel${index}`,\n      style: _normalizeStyle({\n        '--underline-width': $data.labelUnderlineWidths[index] + 'px'\n      })\n    }, _toDisplayString(field.label), 5), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_el_input, {\n      modelValue: $data.formData[field.key],\n      \"onUpdate:modelValue\": $event => $data.formData[field.key] = $event,\n      placeholder: field.placeholder,\n      type: field.type || 'text',\n      \"show-password\": field.showPassword,\n      class: \"password-input\",\n      onKeyup: _withKeys($options.handleSubmit, [\"enter\", \"native\"]),\n      onFocus: $options.handleInputFocus,\n      onBlur: $options.handleInputBlur\n    }, null, 8, [\"modelValue\", \"onUpdate:modelValue\", \"placeholder\", \"type\", \"show-password\", \"onKeyup\", \"onFocus\", \"onBlur\"]), _cache[0] || (_cache[0] = _createElementVNode(\"div\", {\n      class: \"input-underline\"\n    }, null, -1))])]);\n  }), 128)), _createVNode(_component_el_button, {\n    class: \"submit\",\n    type: \"primary\",\n    onClick: $options.handleSubmit\n  }, {\n    default: _withCtx(() => [_createTextVNode(_toDisplayString($props.submitText), 1)]),\n    _: 1\n  }, 8, [\"onClick\"])]), _createVNode(_component_Footer, {\n    class: \"footer\"\n  })]);\n}","import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport Footer from '@/components/Footer.vue';\nimport ToggleDark from '@/components/ToggleDark.vue';\nimport Logo from '@/components/Logo.vue';\nimport { mapGetters } from 'vuex';\nimport backgroundManager from '@/mixins/backgroundManager';\nexport default {\n  name: 'BaseLogin',\n  mixins: [backgroundManager],\n  props: {\n    // 页面标题\n    title: {\n      type: String,\n      required: true\n    },\n    // 输入字段配置\n    fields: {\n      type: Array,\n      required: true\n      // fields 格式: [{ key: 'username', label: '用户名', placeholder: '请输入用户名', type: 'text', showPassword: false }]\n    },\n    // 提交按钮文本\n    submitText: {\n      type: String,\n      default: '登录'\n    },\n    // 背景图配置键名\n    backgroundKey: {\n      type: String,\n      required: true\n    },\n    // 是否为管理端登录（影响背景样式）\n    isAdmin: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      formData: {},\n      labelUnderlineWidths: []\n    };\n  },\n  computed: {\n    ...mapGetters(['userConfig'])\n  },\n  watch: {\n    fields: {\n      handler() {\n        this.$nextTick(() => {\n          this.calculateLabelWidths();\n        });\n      },\n      deep: true\n    }\n  },\n  components: {\n    Footer,\n    ToggleDark,\n    Logo\n  },\n  mounted() {\n    // 初始化表单数据\n    this.initFormData();\n    // 初始化背景图\n    this.initializeBackground(this.backgroundKey, '.login', !this.isAdmin, true);\n    // 在下一个tick计算标签宽度，确保DOM已经渲染\n    this.$nextTick(() => {\n      this.calculateLabelWidths();\n    });\n  },\n  methods: {\n    initFormData() {\n      // 根据字段配置初始化表单数据\n      const newFormData = {};\n      this.fields.forEach(field => {\n        newFormData[field.key] = '';\n      });\n      this.formData = newFormData;\n      // 初始化下划线宽度数组\n      this.labelUnderlineWidths = new Array(this.fields.length).fill(0);\n    },\n    calculateLabelWidths() {\n      // 计算每个标签的文字宽度\n      this.$nextTick(() => {\n        this.fields.forEach((field, index) => {\n          const labelRef = this.$refs[`inputLabel${index}`];\n          if (labelRef && labelRef[0]) {\n            // 创建一个临时的canvas来测量文字宽度\n            const canvas = document.createElement('canvas');\n            const context = canvas.getContext('2d');\n\n            // 获取标签的计算样式\n            const labelElement = labelRef[0];\n            const computedStyle = window.getComputedStyle(labelElement);\n\n            // 设置font样式以匹配标签\n            context.font = `${computedStyle.fontWeight} ${computedStyle.fontSize} ${computedStyle.fontFamily}`;\n\n            // 测量文字宽度\n            const textWidth = context.measureText(field.label).width;\n\n            // 添加一些额外的边距，确保下划线覆盖整个文字\n            this.labelUnderlineWidths[index] = Math.ceil(textWidth) + 3;\n          }\n        });\n      });\n    },\n    handleSubmit() {\n      // 触发父组件的提交事件，传递表单数据\n      this.$emit('submit', {\n        ...this.formData\n      });\n    },\n    handleInputFocus(event) {\n      const container = event.target.closest('.input-container');\n      if (container) {\n        const wrapper = container.querySelector('.input-wrapper');\n        if (wrapper) {\n          wrapper.classList.add('focused');\n        }\n      }\n    },\n    handleInputBlur(event) {\n      const container = event.target.closest('.input-container');\n      if (container) {\n        const wrapper = container.querySelector('.input-wrapper');\n        if (wrapper) {\n          wrapper.classList.remove('focused');\n        }\n      }\n    }\n  }\n};","/* unplugin-vue-components disabled */import { render } from \"./BaseLogin.vue?vue&type=template&id=61197d6f&scoped=true\"\nimport script from \"./BaseLogin.vue?vue&type=script&lang=js\"\nexport * from \"./BaseLogin.vue?vue&type=script&lang=js\"\n\nimport \"./BaseLogin.vue?vue&type=style&index=0&id=61197d6f&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-61197d6f\"]])\n\nexport default __exports__","import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\";\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_BaseLogin = _resolveComponent(\"BaseLogin\");\n  return _openBlock(), _createBlock(_component_BaseLogin, {\n    title: $options.loginTitle,\n    fields: $data.loginFields,\n    \"submit-text\": \"登录\",\n    \"background-key\": \"loginBkImg\",\n    \"is-admin\": false,\n    onSubmit: $options.handleLogin\n  }, null, 8, [\"title\", \"fields\", \"onSubmit\"]);\n}","import \"core-js/modules/es.array.push.js\";\nimport cookies from 'vue-cookies';\nimport axios from '@/utils/axios';\nimport { mapGetters } from 'vuex';\nimport BaseLogin from '@/components/BaseLogin.vue';\nexport default {\n  data() {\n    return {\n      loginFields: [{\n        key: 'password',\n        label: '密码',\n        placeholder: '请输入认证码',\n        type: 'password',\n        showPassword: true\n      }]\n    };\n  },\n  computed: {\n    ...mapGetters(['userConfig']),\n    ownerName() {\n      return this.userConfig?.ownerName || 'Sanyue';\n    },\n    loginTitle() {\n      return `登录到 ${this.ownerName} 图床`;\n    }\n  },\n  components: {\n    BaseLogin\n  },\n  methods: {\n    handleLogin(formData) {\n      const {\n        password\n      } = formData;\n      const writtenPass = password === '' ? 'unset' : password;\n      axios.post('/api/login', {\n        authCode: password\n      }).then(res => {\n        if (res.status !== 200) {\n          this.$message.error('登录失败，请检查密码是否正确');\n          return;\n        }\n        cookies.set('authCode', writtenPass, '14d');\n        this.$router.push('/');\n        this.$message.success('登录成功');\n      }).catch(err => {\n        this.$message.error('登录失败，请检查密码是否正确');\n      });\n    }\n  }\n};","/* unplugin-vue-components disabled */import { render } from \"./Login.vue?vue&type=template&id=25858634\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","tabindex","_hoisted_4","render","_ctx","_cache","$props","$setup","$data","$options","_component_ToggleDark","_component_Logo","_component_el_input","_component_el_button","_component_Footer","title","fields","field","index","key","ref_for","ref","style","labelUnderlineWidths","label","modelValue","formData","$event","placeholder","type","showPassword","onKeyup","handleSubmit","onFocus","handleInputFocus","onBlur","handleInputBlur","onClick","default","submitText","_","name","mixins","backgroundManager","props","String","required","Array","backgroundKey","isAdmin","Boolean","data","computed","watch","handler","this","$nextTick","calculateLabelWidths","deep","components","Footer","ToggleDark","Logo","mounted","initFormData","initializeBackground","methods","newFormData","forEach","length","fill","labelRef","$refs","canvas","document","createElement","context","getContext","labelElement","computedStyle","window","getComputedStyle","font","fontWeight","fontSize","fontFamily","textWidth","measureText","width","Math","ceil","$emit","event","container","target","closest","wrapper","querySelector","classList","add","remove","__exports__","_component_BaseLogin","loginTitle","loginFields","onSubmit","handleLogin","ownerName","userConfig","BaseLogin","password","writtenPass","axios","post","authCode","then","res","status","$router","push","$message","success","error","catch","err"],"sourceRoot":""}